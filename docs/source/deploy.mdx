---
title: Deploy the MCP Server
---

## Recommended: Apollo Runtime Container (All-in-One)

**For most production deployments, we recommend Apollo Runtime container.** It includes everything you need to serve both GraphQL and MCP requests in a single, optimized container.

### Why choose the All-in-One container?

- **Simplified operations**: Single container to deploy and manage
- **Optimized performance**: Apollo Router and Apollo MCP Server are co-located
- **Built-in best practices**: Pre-configured for production use
- **Easier scaling**: Scale both GraphQL and MCP together
- **Unified monitoring**: Single service to monitor and debug

### Deploy Apollo Runtime container

Apollo Runtime container includes all services necessary to serve GraphQL and MCP requests, including Apollo Router and Apollo MCP Server. Both port `4000` (GraphQL) and `5000` (MCP) are exposed.

```bash title="Deploy with GraphOS (Recommended)"
docker run \
  -p 4000:4000 \
  -p 5050:5000 \
  --env APOLLO_GRAPH_REF="<your-graph-ref>" \
  --env APOLLO_KEY="<your-graph-api-key>" \
  --env MCP_ENABLE=1 \
  --rm \
  ghcr.io/apollographql/apollo-runtime:latest
```

When you run this, it will:

- Fetch your schema from GraphOS
- Configure Apollo Router with your supergraph
- Enable Apollo MCP Server endpoint at `/mcp`
- Provide access to your GraphOS persisted queries for MCP tool configuration

<Note>

You'll still need to configure which operations to expose as MCP tools. See [Define MCP Tools](/apollo-mcp-server/define-tools) for configuration options.

</Note>

To learn more, review the [Apollo Runtime container documentation](/graphos/routing/self-hosted/containerization/docker).

## Alternative: Standalone Apollo MCP Server container

**Use this option only if you already have a GraphQL API running elsewhere** and want to add MCP capabilities to it.

### Deploy standalone Apollo MCP Server container

Apollo MCP Server is available as a standalone Docker container. Container images are downloadable using the image `ghcr.io/apollographql/apollo-mcp-server`.

By default, the container expects all schema and operation files to be present in the `/data` directory within the container and that clients use Streamable HTTP transport on container port `5050`.

Here's an example `docker run` command that runs Apollo MCP Server for the space dev example:

```yaml title="Example config for using Docker"
endpoint: https://thespacedevs-production.up.railway.app/
operations:
  source: local
  paths:
    - /data/operations/
schema:
  source: local
  path: /data/api.graphql
```

```sh showLineNumbers=false
docker run \
  -it --rm \
  --name apollo-mcp-server \
  -p 5050:5050 \
  -v <path to the preceding config>:/config.yaml \
  -v $PWD/graphql/TheSpaceDevs:/data \
  --pull always \
  ghcr.io/apollographql/apollo-mcp-server:latest /config.yaml
```

## When to choose which option?

| Scenario | Recommended Option | Why |
|----------|-------------------|-----|
| **New GraphQL + MCP deployment** | **Apollo Runtime Container** | Single container, easier to manage, optimized performance |
| **Adding MCP to existing GraphQL API** | Standalone Apollo MCP Server | Connect to your existing GraphQL endpoint |
| **GraphOS managed graph** | **Apollo Runtime Container** | Automatic schema/PQ sync, unified telemetry |
| **Local development** | Either option works | Choose what matches your production setup |
| **Kubernetes/orchestrated environment** | **Apollo Runtime Container** | Fewer moving parts, simpler networking |

## Production Considerations

### Load Balancing & Session Affinity

**Important**: MCP is a stateful protocol that requires session affinity (sticky sessions).

When an MCP client initializes a session with Apollo MCP Server, it receives a session identifier unique to that server instance through the `mcp-session-id` header. You must enable session affinity in your load balancer so that all requests sharing the same `mcp-session-id` are routed to the same backend instance.

**Cloud Provider Support:**

- Most cloud load balancers (ALB, GCP LB) don't support header-based session affinity
- Use Nginx, HAProxy, or Envoy/Istio for proper session routing

### Scaling Recommendations

**Apollo Runtime Container** (Recommended):

- Scale both GraphQL and MCP together as a single unit
- Simpler horizontal scaling
- Consistent performance characteristics

**Standalone Apollo MCP Server**:

- Scale Apollo MCP Server independently of your GraphQL API
- More complex but enables fine-tuned resource allocation

### Next steps

After you deploy, configure:

1. [Health checks](/apollo-mcp-server/health-checks) for monitoring
2. [CORS settings](/apollo-mcp-server/cors) for browser clients
3. [Authorization](/apollo-mcp-server/auth) for production security
